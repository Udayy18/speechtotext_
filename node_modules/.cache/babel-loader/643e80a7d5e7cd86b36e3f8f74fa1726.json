{"ast":null,"code":"// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT license.\n\n/* eslint-disable max-classes-per-file */\nimport { CancellationErrorCodePropertyName } from \"../common.speech/Exports\";\nimport { CancellationDetailsBase, CancellationErrorCode, CancellationReason, PropertyCollection, ResultReason } from \"./Exports\";\n\nconst parse = json => JSON.parse(json);\n/**\n * Output format\n * @class VoiceProfileEnrollmentResult\n */\n\n\nexport class VoiceProfileEnrollmentResult {\n  constructor(reason, json, statusText) {\n    this.privReason = reason;\n    this.privProperties = new PropertyCollection();\n\n    if (this.privReason !== ResultReason.Canceled) {\n      if (!!json) {\n        this.privDetails = parse(json);\n\n        if (this.privDetails.enrollmentStatus.toLowerCase() === \"enrolling\") {\n          this.privReason = ResultReason.EnrollingVoiceProfile;\n        }\n      }\n    } else {\n      this.privErrorDetails = statusText;\n      this.privProperties.setProperty(CancellationErrorCodePropertyName, CancellationErrorCode[CancellationErrorCode.ServiceError]);\n    }\n  }\n\n  get reason() {\n    return this.privReason;\n  }\n\n  get enrollmentsCount() {\n    return this.privDetails.enrollmentsCount;\n  }\n\n  get enrollmentsLengthInSec() {\n    return this.privDetails.enrollmentsLengthInSec;\n  }\n\n  get properties() {\n    return this.privProperties;\n  }\n\n  get enrollmentResultDetails() {\n    return this.privDetails;\n  }\n\n  get errorDetails() {\n    return this.privErrorDetails;\n  }\n\n  static FromIdentificationProfileList(json) {\n    const results = [];\n\n    for (const item of json.value) {\n      const reason = item.enrollmentStatus.toLowerCase() === \"enrolling\" ? ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === \"enrolled\" ? ResultReason.EnrolledVoiceProfile : ResultReason.Canceled;\n      const result = new VoiceProfileEnrollmentResult(reason, null, null);\n      result.privDetails = this.getIdentificationDetails(item);\n      results.push(result);\n    }\n\n    return results;\n  }\n\n  static FromVerificationProfileList(json) {\n    const results = [];\n\n    for (const item of json.value) {\n      const reason = item.enrollmentStatus.toLowerCase() === \"enrolling\" ? ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === \"enrolled\" ? ResultReason.EnrolledVoiceProfile : ResultReason.Canceled;\n      const result = new VoiceProfileEnrollmentResult(reason, null, null);\n      result.privDetails = this.getVerificationDetails(item);\n      results.push(result);\n    }\n\n    return results;\n  }\n\n  static getIdentificationDetails(json) {\n    return {\n      audioLengthInSec: json.audioLengthInSec ? parseFloat(json.audioLengthInSec) : 0,\n      audioSpeechLengthInSec: json.audioSpeechLengthInSec ? parseFloat(json.audioSpeechLengthInSec) : 0,\n      enrollmentStatus: json.enrollmentStatus,\n      enrollmentsCount: json.enrollmentsCount || 0,\n      enrollmentsLengthInSec: json.enrollmentsLengthInSec ? parseFloat(json.enrollmentsLengthInSec) : 0,\n      enrollmentsSpeechLengthInSec: json.enrollmentsSpeechLengthInSec ? parseFloat(json.enrollmentsSpeechLengthInSec) : 0,\n      profileId: json.profileId || json.identificationProfileId,\n      remainingEnrollmentsSpeechLengthInSec: json.remainingEnrollmentsSpeechLengthInSec ? parseFloat(json.remainingEnrollmentsSpeechLengthInSec) : 0\n    };\n  }\n\n  static getVerificationDetails(json) {\n    return {\n      audioLengthInSec: json.audioLengthInSec ? parseFloat(json.audioLengthInSec) : 0,\n      audioSpeechLengthInSec: json.audioSpeechLengthInSec ? parseFloat(json.audioSpeechLengthInSec) : 0,\n      enrollmentStatus: json.enrollmentStatus,\n      enrollmentsCount: json.enrollmentsCount,\n      enrollmentsLengthInSec: json.enrollmentsLengthInSec ? parseFloat(json.enrollmentsLengthInSec) : 0,\n      enrollmentsSpeechLengthInSec: json.enrollmentsSpeechLengthInSec ? parseFloat(json.enrollmentsSpeechLengthInSec) : 0,\n      profileId: json.profileId || json.verificationProfileId,\n      remainingEnrollmentsCount: json.remainingEnrollments || json.remainingEnrollmentsCount,\n      remainingEnrollmentsSpeechLengthInSec: json.remainingEnrollmentsSpeechLengthInSec ? parseFloat(json.remainingEnrollmentsSpeechLengthInSec) : 0\n    };\n  }\n\n}\n/**\n * @class VoiceProfileEnrollmentCancellationDetails\n */\n\nexport class VoiceProfileEnrollmentCancellationDetails extends CancellationDetailsBase {\n  constructor(reason, errorDetails, errorCode) {\n    super(reason, errorDetails, errorCode);\n  }\n  /**\n   * Creates an instance of VoiceProfileEnrollmentCancellationDetails object for the canceled VoiceProfileEnrollmentResult.\n   * @member VoiceProfileEnrollmentCancellationDetails.fromResult\n   * @function\n   * @public\n   * @param {VoiceProfileEnrollmentResult} result - The result that was canceled.\n   * @returns {VoiceProfileEnrollmentCancellationDetails} The cancellation details object being created.\n   */\n\n\n  static fromResult(result) {\n    const reason = CancellationReason.Error;\n    let errorCode = CancellationErrorCode.NoError;\n\n    if (!!result.properties) {\n      errorCode = CancellationErrorCode[result.properties.getProperty(CancellationErrorCodePropertyName, CancellationErrorCode[CancellationErrorCode.NoError])]; //eslint-disable-line\n    }\n\n    return new VoiceProfileEnrollmentCancellationDetails(reason, result.errorDetails, errorCode);\n  }\n\n}","map":{"version":3,"sources":["src/sdk/VoiceProfileEnrollmentResult.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT license.\r\n\r\n/* eslint-disable max-classes-per-file */\r\nimport { CancellationErrorCodePropertyName } from \"../common.speech/Exports\";\r\nimport {\r\n    CancellationDetailsBase,\r\n    CancellationErrorCode,\r\n    CancellationReason,\r\n    PropertyCollection,\r\n    ResultReason\r\n} from \"./Exports\";\r\n\r\nexport interface EnrollmentResultDetails {\r\n    profileId: string;\r\n    enrollmentsCount: number;\r\n    enrollmentsLengthInSec: number;\r\n    enrollmentsSpeechLengthInSec: number;\r\n    remainingEnrollmentsCount: number;\r\n    remainingEnrollmentsSpeechLengthInSec: number;\r\n    audioLengthInSec: number;\r\n    audioSpeechLengthInSec: number;\r\n    enrollmentStatus: string;\r\n}\r\n\r\nexport interface EnrollmentResultJSON {\r\n    profileId: string;\r\n    enrollmentsCount: number;\r\n    enrollmentsLengthInSec: string;\r\n    enrollmentsSpeechLengthInSec: string;\r\n    remainingEnrollmentsCount: number;\r\n    remainingEnrollmentsSpeechLengthInSec: string;\r\n    audioLengthInSec: string;\r\n    audioSpeechLengthInSec: string;\r\n    enrollmentStatus: string;\r\n    remainingEnrollments?: number;\r\n    identificationProfileId?: string;\r\n    verificationProfileId?: string;\r\n}\r\n\r\nconst parse = (json: string): EnrollmentResultDetails => JSON.parse(json) as EnrollmentResultDetails;\r\n\r\n/**\r\n * Output format\r\n * @class VoiceProfileEnrollmentResult\r\n */\r\nexport class VoiceProfileEnrollmentResult {\r\n    private privReason: ResultReason;\r\n    private privDetails: EnrollmentResultDetails;\r\n    private privProperties: PropertyCollection;\r\n    private privErrorDetails: string;\r\n\r\n    public constructor(reason: ResultReason, json: string, statusText: string) {\r\n        this.privReason = reason;\r\n        this.privProperties = new PropertyCollection();\r\n        if (this.privReason !== ResultReason.Canceled) {\r\n            if (!!json) {\r\n                this.privDetails = parse(json);\r\n                if (this.privDetails.enrollmentStatus.toLowerCase() === \"enrolling\") {\r\n                    this.privReason = ResultReason.EnrollingVoiceProfile;\r\n                }\r\n            }\r\n        } else {\r\n            this.privErrorDetails = statusText;\r\n            this.privProperties.setProperty(CancellationErrorCodePropertyName, CancellationErrorCode[CancellationErrorCode.ServiceError]);\r\n        }\r\n    }\r\n\r\n    public get reason(): ResultReason {\r\n        return this.privReason;\r\n    }\r\n\r\n    public get enrollmentsCount(): number {\r\n        return this.privDetails.enrollmentsCount;\r\n    }\r\n\r\n    public get enrollmentsLengthInSec(): number {\r\n        return this.privDetails.enrollmentsLengthInSec;\r\n    }\r\n\r\n    public get properties(): PropertyCollection {\r\n        return this.privProperties;\r\n    }\r\n\r\n    public get enrollmentResultDetails(): EnrollmentResultDetails {\r\n        return this.privDetails;\r\n    }\r\n\r\n    public get errorDetails(): string {\r\n        return this.privErrorDetails;\r\n    }\r\n\r\n    public static FromIdentificationProfileList(json: { value: EnrollmentResultJSON[] }): VoiceProfileEnrollmentResult[] {\r\n        const results: VoiceProfileEnrollmentResult[] = [];\r\n        for (const item of json.value) {\r\n            const reason: ResultReason = item.enrollmentStatus.toLowerCase() === \"enrolling\" ?\r\n                ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === \"enrolled\" ?\r\n                ResultReason.EnrolledVoiceProfile : ResultReason.Canceled;\r\n            const result = new VoiceProfileEnrollmentResult(reason, null, null);\r\n            result.privDetails = this.getIdentificationDetails(item) as EnrollmentResultDetails;\r\n            results.push(result);\r\n        }\r\n        return results;\r\n    }\r\n\r\n    public static FromVerificationProfileList(json: { value: EnrollmentResultJSON[] }): VoiceProfileEnrollmentResult[] {\r\n        const results: VoiceProfileEnrollmentResult[] = [];\r\n        for (const item of json.value) {\r\n            const reason: ResultReason = item.enrollmentStatus.toLowerCase() === \"enrolling\" ?\r\n                ResultReason.EnrollingVoiceProfile : item.enrollmentStatus.toLowerCase() === \"enrolled\" ?\r\n                ResultReason.EnrolledVoiceProfile : ResultReason.Canceled;\r\n            const result = new VoiceProfileEnrollmentResult(reason, null, null);\r\n            result.privDetails = this.getVerificationDetails(item) as EnrollmentResultDetails;\r\n            results.push(result);\r\n        }\r\n        return results;\r\n    }\r\n\r\n    private static getIdentificationDetails(json: EnrollmentResultJSON): unknown {\r\n        return {\r\n            audioLengthInSec: json.audioLengthInSec ? parseFloat(json.audioLengthInSec) : 0,\r\n            audioSpeechLengthInSec: json.audioSpeechLengthInSec ? parseFloat(json.audioSpeechLengthInSec) : 0,\r\n            enrollmentStatus: json.enrollmentStatus,\r\n            enrollmentsCount: json.enrollmentsCount || 0,\r\n            enrollmentsLengthInSec: json.enrollmentsLengthInSec ? parseFloat(json.enrollmentsLengthInSec) : 0,\r\n            enrollmentsSpeechLengthInSec: json.enrollmentsSpeechLengthInSec ? parseFloat(json.enrollmentsSpeechLengthInSec) : 0,\r\n            profileId: json.profileId || json.identificationProfileId,\r\n            remainingEnrollmentsSpeechLengthInSec: json.remainingEnrollmentsSpeechLengthInSec ? parseFloat(json.remainingEnrollmentsSpeechLengthInSec) : 0\r\n        };\r\n    }\r\n\r\n    private static getVerificationDetails(json: EnrollmentResultJSON): unknown {\r\n        return {\r\n            audioLengthInSec: json.audioLengthInSec ? parseFloat(json.audioLengthInSec) : 0,\r\n            audioSpeechLengthInSec: json.audioSpeechLengthInSec ? parseFloat(json.audioSpeechLengthInSec) : 0,\r\n            enrollmentStatus: json.enrollmentStatus,\r\n            enrollmentsCount: json.enrollmentsCount,\r\n            enrollmentsLengthInSec: json.enrollmentsLengthInSec ? parseFloat(json.enrollmentsLengthInSec) : 0,\r\n            enrollmentsSpeechLengthInSec: json.enrollmentsSpeechLengthInSec ? parseFloat(json.enrollmentsSpeechLengthInSec) : 0,\r\n            profileId: json.profileId || json.verificationProfileId,\r\n            remainingEnrollmentsCount: json.remainingEnrollments || json.remainingEnrollmentsCount,\r\n            remainingEnrollmentsSpeechLengthInSec: json.remainingEnrollmentsSpeechLengthInSec ? parseFloat(json.remainingEnrollmentsSpeechLengthInSec) : 0\r\n        };\r\n    }\r\n}\r\n\r\n/**\r\n * @class VoiceProfileEnrollmentCancellationDetails\r\n */\r\nexport class VoiceProfileEnrollmentCancellationDetails extends CancellationDetailsBase {\r\n\r\n    private constructor(reason: CancellationReason, errorDetails: string, errorCode: CancellationErrorCode) {\r\n        super(reason, errorDetails, errorCode);\r\n    }\r\n\r\n    /**\r\n     * Creates an instance of VoiceProfileEnrollmentCancellationDetails object for the canceled VoiceProfileEnrollmentResult.\r\n     * @member VoiceProfileEnrollmentCancellationDetails.fromResult\r\n     * @function\r\n     * @public\r\n     * @param {VoiceProfileEnrollmentResult} result - The result that was canceled.\r\n     * @returns {VoiceProfileEnrollmentCancellationDetails} The cancellation details object being created.\r\n     */\r\n    public static fromResult(result: VoiceProfileEnrollmentResult): VoiceProfileEnrollmentCancellationDetails {\r\n        const reason = CancellationReason.Error;\r\n        let errorCode: CancellationErrorCode = CancellationErrorCode.NoError;\r\n\r\n        if (!!result.properties) {\r\n            errorCode = (CancellationErrorCode as any)[result.properties.getProperty(CancellationErrorCodePropertyName, CancellationErrorCode[CancellationErrorCode.NoError])]; //eslint-disable-line\r\n        }\r\n\r\n        return new VoiceProfileEnrollmentCancellationDetails(reason, result.errorDetails, errorCode);\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}